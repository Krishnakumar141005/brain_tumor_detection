{% extends "base.html" %}
{% block content %}
<section class="row g-4 align-items-center mb-5">
  <div class="col-xl-6">
    <div class="glass-card p-4 p-lg-5 h-100">
      <span class="badge bg-info text-dark mb-3">AI-Driven · Clinically Inspired</span>
      <h1 class="display-5 fw-bold text-white mb-3">Brain Tumor Detection Suite</h1>
      <p class="lead text-white-50 mb-4">
        Detect, interpret, and communicate MRI insights in seconds. Our lightweight CNN pairs high-precision predictions with Grad-CAM overlays so clinicians gain both accuracy and explainability.
      </p>
      <div class="d-flex flex-column flex-md-row gap-3">
        {% if current_user.is_authenticated %}
          <a href="#predict-section" class="btn btn-gradient btn-lg px-4 py-2">Launch Diagnosis</a>
          <div class="d-flex align-items-center text-white-50 ps-md-3">
            <div class="small">Signed in as<br><strong>{{ current_user.full_name }}</strong></div>
          </div>
        {% else %}
          <a href="{{ url_for('register') }}" class="btn btn-gradient btn-lg px-4 py-2">Create Account</a>
          <a href="{{ url_for('login') }}" class="btn btn-outline-light btn-lg px-4 py-2">Log In</a>
        {% endif %}
      </div>
      <div class="mt-4 text-white-50 small">
        <div class="d-flex align-items-center gap-2 mb-2">
          <span class="badge bg-success">Explainable</span>
          Transparency through Grad-CAM heatmaps for every prediction.
        </div>
        <div class="d-flex align-items-center gap-2 mb-2">
          <span class="badge bg-primary">Realtime</span>
          Upload to insights in under 2 seconds on typical hardware.
        </div>
        <div class="d-flex align-items-center gap-2">
          <span class="badge bg-warning text-dark">Secure</span>
          Patient scans remain private to your authenticated workspace.
        </div>
      </div>
    </div>
  </div>
  <div class="col-xl-6">
    <div class="glass-card p-4 p-lg-5" id="predict-section">
      {% if current_user.is_authenticated %}
        <h2 class="fw-semibold text-white mb-4">Upload MRI for Analysis</h2>
        <form action="{{ url_for('predict') }}" method="post" enctype="multipart/form-data" class="d-grid gap-3">
          <div class="border border-dashed rounded-4 py-4 px-3 border-secondary bg-transparent text-center">
            <input class="form-control form-control-lg" type="file" name="file" accept=".png,.jpg,.jpeg" required>
            <p class="small text-white-50 mt-2 mb-0">PNG or JPG · Optimal size 128×128 px · Grayscale recommended.</p>
          </div>
          <button type="submit" class="btn btn-gradient btn-lg">Run Diagnosis</button>
        </form>
      {% else %}
        <div class="text-center py-5">
          <span class="badge bg-secondary mb-3">Access Restricted</span>
          <h2 class="fw-semibold text-white mb-3">Sign in to Continue</h2>
          <p class="text-white-50 mb-4">Create an account or log in to access the diagnostic workspace and upload MRI scans.</p>
          <div class="d-flex justify-content-center gap-3">
            <a href="{{ url_for('login') }}" class="btn btn-outline-light btn-lg">Log In</a>
            <a href="{{ url_for('register') }}" class="btn btn-gradient btn-lg">Create Account</a>
          </div>
        </div>
      {% endif %}

      {% if result %}
        <div class="mt-5 pt-4 border-top border-secondary">
          <h3 class="fw-semibold text-white mb-3">Prediction Summary</h3>
          <div class="row g-3">
            <div class="col-md-5">
              <div class="stats-card p-3 h-100">
                <h6 class="text-white-50">Diagnosis</h6>
                <p class="fs-3 fw-bold {% if result == 'Tumor' %}text-danger{% else %}text-info{% endif %} mb-1">{{ result }}</p>
                <span class="badge bg-dark text-white-50">Confidence: {{ prob }}</span>
              </div>
            </div>
            <div class="col-md-7">
              <div class="stats-card p-3 h-100">
                <h6 class="text-white-50">Uploaded MRI</h6>
                <img src="{{ original_image }}" alt="Original MRI" class="img-fluid rounded-4 shadow-sm">
              </div>
            </div>
          </div>
          <div class="mt-4">
            {% if heatmap_image %}
              <h6 class="text-white-50 mb-2">Explainable Heatmap</h6>
              <img src="{{ heatmap_image }}" alt="Grad-CAM Heatmap" class="img-fluid rounded-4 shadow-sm">
            {% else %}
              <div class="alert alert-warning mt-2" role="alert">
                Grad-CAM visualization could not be generated for this scan. Please try another image or re-run the analysis.
              </div>
            {% endif %}
          </div>
        </div>
      {% endif %}
    </div>
  </div>
</section>

<section class="mt-5">
  <div class="row g-4">
    <div class="col-md-4">
      <div class="stats-card h-100 p-4">
        <h3 class="display-6 fw-bold text-white mb-1">94%</h3>
        <p class="text-white-50 mb-2">Validation Accuracy</p>
        <p class="text-white-50 small mb-0">Measured on curated MRI validation set with class-balanced sampling.</p>
      </div>
    </div>
    <div class="col-md-4">
      <div class="stats-card h-100 p-4">
        <h3 class="display-6 fw-bold text-white mb-1">2.3s</h3>
        <p class="text-white-50 mb-2">Average Turnaround</p>
        <p class="text-white-50 small mb-0">Prediction & visualization latency on modest CPU hardware.</p>
      </div>
    </div>
    <div class="col-md-4">
      <div class="stats-card h-100 p-4">
        <h3 class="display-6 fw-bold text-white mb-1">100+</h3>
        <p class="text-white-50 mb-2">Scans Reviewed</p>
        <p class="text-white-50 small mb-0">Includes Kaggle datasets and locally curated clinical samples.</p>
      </div>
    </div>
  </div>
</section>

<section class="mt-5">
  <div class="glass-card p-4 p-lg-5">
    <div class="row g-4 align-items-center">
      <div class="col-lg-5">
        <h2 class="fw-bold text-white mb-3">Why Clinicians Love NeuroVision</h2>
        <p class="text-white-50 mb-4">We focus on trust, interpretability, and simple workflows that integrate with existing radiology routines.</p>
        <ul class="list-unstyled text-white-50 small mb-0">
          <li class="mb-3">✅ <strong>Transparent AI</strong> &mdash; every prediction paired with a heatmap highlight.</li>
          <li class="mb-3">✅ <strong>Secure by design</strong> &mdash; local processing keeps patient data in-house.</li>
          <li class="mb-3">✅ <strong>Ready for deployment</strong> &mdash; lightweight Flask stack with modular components.</li>
        </ul>
      </div>
      <div class="col-lg-7">
        <div class="row g-3">
          <div class="col-sm-6">
            <div class="glass-card h-100 p-4">
              <span class="badge bg-primary mb-3">Radiologist Insight</span>
              <p class="text-white-50">“The Grad-CAM overlays let me quickly verify the CNN's focus, making it easier to incorporate into my diagnostic routine.”</p>
              <p class="text-white small mb-0">Dr. A. Sharma · Consultant Radiologist</p>
            </div>
          </div>
          <div class="col-sm-6">
            <div class="glass-card h-100 p-4">
              <span class="badge bg-success mb-3">Research Validation</span>
              <p class="text-white-50">“This platform accelerated our experimentation for brain tumor segmentation, especially with its clean API.”</p>
              <p class="text-white small mb-0">Prof. R. Verma · Medical AI Lab</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="mt-5">
  <h2 class="fw-bold text-white mb-4 text-center">Workflow at a Glance</h2>
  <div class="row g-4">
    <div class="col-md-4">
      <div class="glass-card h-100 p-4 text-center">
        <span class="badge bg-light text-dark mb-3">Step 01</span>
        <h5 class="fw-semibold text-white mb-2">Upload MRI Scan</h5>
        <p class="text-white-50 small mb-0">Drag & drop anonymized DICOM exports or JPG/PNG slices into the secure workspace.</p>
      </div>
    </div>
    <div class="col-md-4">
      <div class="glass-card h-100 p-4 text-center">
        <span class="badge bg-light text-dark mb-3">Step 02</span>
        <h5 class="fw-semibold text-white mb-2">AI Evaluation</h5>
        <p class="text-white-50 small mb-0">Our CNN processes the image, predicts tumor presence, and composes Grad-CAM heatmaps.</p>
      </div>
    </div>
    <div class="col-md-4">
      <div class="glass-card h-100 p-4 text-center">
        <span class="badge bg-light text-dark mb-3">Step 03</span>
        <h5 class="fw-semibold text-white mb-2">Review & Export</h5>
        <p class="text-white-50 small mb-0">Interpret predictions, download annotated outputs, and archive for future reference.</p>
      </div>
    </div>
  </div>
</section>

<section class="mt-5">
  <div class="glass-card p-4 p-lg-5">
    <div class="row g-4 align-items-center">
      <div class="col-lg-8">
        <h3 class="fw-bold text-white mb-2">Ready to elevate your diagnostics?</h3>
        <p class="text-white-50 mb-0">Join NeuroVision and empower your team with explainable AI that accelerates confident decision making.</p>
      </div>
      <div class="col-lg-4 text-lg-end">
        {% if current_user.is_authenticated %}
          <a href="#predict-section" class="btn btn-gradient btn-lg px-4">Start a New Analysis</a>
        {% else %}
          <a href="{{ url_for('register') }}" class="btn btn-gradient btn-lg px-4">Create Free Account</a>
        {% endif %}
      </div>
    </div>
  </div>
</section>
{% endblock %}
